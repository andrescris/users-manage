# ğŸ”¥ Alimedia Firebase API

Una API RESTful robusta construida en Go que proporciona una interfaz completa para gestionar usuarios y documentos de Firebase, incluyendo Firebase Authentication y Firestore.

## ğŸ“‹ Tabla de Contenidos

- [CaracterÃ­sticas](#-caracterÃ­sticas)
- [TecnologÃ­as](#-tecnologÃ­as)
- [InstalaciÃ³n](#-instalaciÃ³n)
- [ConfiguraciÃ³n](#-configuraciÃ³n)
- [Uso](#-uso)
- [Endpoints de la API](#-endpoints-de-la-api)
- [Ejemplos con curl](#-ejemplos-con-curl)
- [Postman](#-postman)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [ContribuciÃ³n](#-contribuciÃ³n)
- [Licencia](#-licencia)

## âœ¨ CaracterÃ­sticas

- ğŸ” **GestiÃ³n completa de usuarios** con Firebase Authentication
- ğŸ“„ **CRUD de documentos** en Firestore
- ğŸ” **Consultas avanzadas** con filtros y ordenamiento
- ğŸ“Š **EstadÃ­sticas y monitoreo** del servidor
- ğŸš€ **API RESTful** bien estructurada
- ğŸ“ **DocumentaciÃ³n integrada** en `/api/v1/docs`
- ğŸŒ **CORS habilitado** para desarrollo frontend
- ğŸ›¡ï¸ **Manejo robusto de errores**

## ğŸ› ï¸ TecnologÃ­as

- **Go 1.21+**
- **Gin Framework** - Router HTTP rÃ¡pido y minimalista
- **Firebase Admin SDK** - Authentication y Firestore
- **Firebase Authentication** - GestiÃ³n de usuarios
- **Cloud Firestore** - Base de datos NoSQL

## ğŸš€ InstalaciÃ³n

### Prerrequisitos

- Go 1.21 o superior
- Proyecto de Firebase configurado
- Credenciales de Firebase Admin SDK

### Pasos de instalaciÃ³n

1. **Clona el repositorio**

   ```bash
   git clone https://github.com/andrescris/alimedia.git
   cd alimedia
   ```

2. **Inicializa el mÃ³dulo Go**

   ```bash
   go mod init github.com/andrescris/alimedia
   go mod tidy
   ```

3. **Instala las dependencias**

   ```bash
   go get github.com/gin-gonic/gin
   go get firebase.google.com/go/v4
   ```

4. **Configura las variables de entorno**
   ```bash
   cp .env.example .env
   # Edita .env con tus credenciales de Firebase
   ```

## âš™ï¸ ConfiguraciÃ³n

### Variables de Entorno

Crea un archivo `.env` en la raÃ­z del proyecto:

```env
# Firebase Configuration
FIREBASE_PROJECT_ID=tu-proyecto-firebase
GOOGLE_APPLICATION_CREDENTIALS=path/to/serviceAccountKey.json

# Server Configuration
PORT=8080
GIN_MODE=debug
```

### Credenciales de Firebase

1. Ve a [Firebase Console](https://console.firebase.google.com/)
2. Selecciona tu proyecto
3. Ve a **ConfiguraciÃ³n del proyecto** > **Cuentas de servicio**
4. Genera una nueva clave privada
5. Descarga el archivo JSON y colÃ³calo en tu proyecto
6. Actualiza la variable `GOOGLE_APPLICATION_CREDENTIALS` en tu `.env`

## ğŸ¯ Uso

### Iniciar el servidor

```bash
go run main.go
```

El servidor estarÃ¡ disponible en: `http://localhost:8080`

### Verificar que funciona

```bash
curl http://localhost:8080/
```

Respuesta esperada:

```json
{
  "message": "ğŸ”¥ Firebase API Server",
  "status": "running",
  "project": "tu-proyecto-firebase"
}
```

## ğŸ“š Endpoints de la API

### ğŸ‘¥ Usuarios

| MÃ©todo   | Endpoint                     | DescripciÃ³n                      |
| -------- | ---------------------------- | -------------------------------- |
| `POST`   | `/api/v1/users`              | Crear nuevo usuario              |
| `GET`    | `/api/v1/users`              | Listar usuarios (paginado)       |
| `GET`    | `/api/v1/users/:uid`         | Obtener usuario por UID          |
| `GET`    | `/api/v1/users/email/:email` | Obtener usuario por email        |
| `PUT`    | `/api/v1/users/:uid`         | Actualizar usuario               |
| `DELETE` | `/api/v1/users/:uid`         | Eliminar usuario                 |
| `POST`   | `/api/v1/users/:uid/claims`  | Establecer claims personalizados |

### ğŸ“„ Documentos

| MÃ©todo   | Endpoint                                        | DescripciÃ³n          |
| -------- | ----------------------------------------------- | -------------------- |
| `POST`   | `/api/v1/collections/:collection/documents`     | Crear documento      |
| `GET`    | `/api/v1/collections/:collection/documents`     | Listar documentos    |
| `GET`    | `/api/v1/collections/:collection/documents/:id` | Obtener documento    |
| `PUT`    | `/api/v1/collections/:collection/documents/:id` | Actualizar documento |
| `DELETE` | `/api/v1/collections/:collection/documents/:id` | Eliminar documento   |

### ğŸ” Consultas

| MÃ©todo | Endpoint                                | DescripciÃ³n           |
| ------ | --------------------------------------- | --------------------- |
| `POST` | `/api/v1/collections/:collection/query` | Consultar con filtros |

### ğŸ› ï¸ Utilidades

| MÃ©todo | Endpoint        | DescripciÃ³n               |
| ------ | --------------- | ------------------------- |
| `GET`  | `/api/v1/stats` | EstadÃ­sticas del servidor |
| `GET`  | `/api/v1/docs`  | DocumentaciÃ³n de la API   |

## ğŸ’» Ejemplos con curl

### Crear un usuario

```bash
curl -X POST http://localhost:8080/api/v1/users \
  -H "Content-Type: application/json" \
  -d '{
    "email": "usuario@ejemplo.com",
    "password": "password123",
    "display_name": "Juan PÃ©rez"
  }'
```

### Listar usuarios

```bash
curl -X GET "http://localhost:8080/api/v1/users?limit=10"
```

### Crear un documento

```bash
curl -X POST http://localhost:8080/api/v1/collections/products/documents \
  -H "Content-Type: application/json" \
  -d '{
    "name": "iPhone 15",
    "price": 999.99,
    "category": "smartphones",
    "in_stock": true
  }'
```

### Consultar documentos con filtros

```bash
curl -X POST http://localhost:8080/api/v1/collections/products/query \
  -H "Content-Type: application/json" \
  -d '{
    "filters": [
      {
        "field": "price",
        "operator": "<",
        "value": 500
      }
    ],
    "limit": 10
  }'
```

## ğŸ“® Postman

### Importar Collection

1. Descarga la [Postman Collection](./docs/postman/alimedia-api.postman_collection.json)
2. Importa en Postman: `File > Import`
3. Configura el environment con:
   - `base_url`: `http://localhost:8080/api/v1`

### Variables de Environment

```json
{
  "base_url": "http://localhost:8080/api/v1",
  "server_url": "http://localhost:8080"
}
```

### Ejemplos de Request Bodies

#### Crear Usuario

```json
{
  "email": "test@ejemplo.com",
  "password": "123456",
  "display_name": "Usuario Test",
  "phone_number": "+573001234567"
}
```

#### Crear Producto

```json
{
  "name": "Laptop Gaming",
  "price": 1500.99,
  "brand": "ASUS",
  "category": "computers",
  "in_stock": true,
  "specs": {
    "cpu": "Intel i7",
    "ram": "16GB",
    "storage": "512GB SSD"
  }
}
```

#### Query con Filtros

```json
{
  "filters": [
    {
      "field": "category",
      "operator": "==",
      "value": "smartphones"
    },
    {
      "field": "price",
      "operator": ">=",
      "value": 500
    }
  ],
  "order_by": [
    {
      "field": "price",
      "direction": "desc"
    }
  ],
  "limit": 20
}
```

## ğŸ“ Estructura del Proyecto

```
alimedia/
â”œâ”€â”€ main.go                          # Punto de entrada de la aplicaciÃ³n
â”œâ”€â”€ go.mod                           # Dependencias del mÃ³dulo
â”œâ”€â”€ go.sum                           # Checksums de dependencias
â”œâ”€â”€ .env                             # Variables de entorno
â”œâ”€â”€ .env.example                     # Ejemplo de variables de entorno
â”œâ”€â”€ README.md                        # Este archivo
â”œâ”€â”€ docs/                            # DocumentaciÃ³n adicional
â”‚   â””â”€â”€ postman/                     # Collections de Postman
â”œâ”€â”€ pkg/                             # CÃ³digo de la aplicaciÃ³n
â”‚   â””â”€â”€ handlers/                    # Handlers HTTP
â”‚       â”œâ”€â”€ user_handlers.go         # GestiÃ³n de usuarios
â”‚       â”œâ”€â”€ document_handlers.go     # GestiÃ³n de documentos
â”‚       â””â”€â”€ utility_handlers.go      # Utilidades y stats
â””â”€â”€ lib/                             # LibrerÃ­as externas
    â””â”€â”€ firebase/                    # ConfiguraciÃ³n de Firebase
        â”œâ”€â”€ firebase.go              # InicializaciÃ³n
        â”œâ”€â”€ auth/                    # Firebase Auth
        â””â”€â”€ firestore/               # Firestore operations
```

## ğŸš¦ CÃ³digos de Estado HTTP

| CÃ³digo | DescripciÃ³n                            |
| ------ | -------------------------------------- |
| `200`  | OperaciÃ³n exitosa                      |
| `201`  | Recurso creado exitosamente            |
| `400`  | Error en la peticiÃ³n (datos invÃ¡lidos) |
| `404`  | Recurso no encontrado                  |
| `500`  | Error interno del servidor             |

## ğŸ”§ Desarrollo

### Ejecutar en modo desarrollo

```bash
export GIN_MODE=debug
go run main.go
```

### Ejecutar tests

```bash
go test ./...
```

### Build para producciÃ³n

```bash
go build -o bin/alimedia main.go
```

### Ejecutar en producciÃ³n

```bash
export GIN_MODE=release
./bin/alimedia
```

## ğŸ¤ ContribuciÃ³n

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

### Convenciones de CÃ³digo

- Usa `gofmt` para formatear el cÃ³digo
- Ejecuta `go vet` para verificar errores
- AÃ±ade tests para nuevas funcionalidades
- Documenta funciones pÃºblicas
- Sigue las convenciones de Go

## ğŸ“„ Licencia

Este proyecto estÃ¡ licenciado bajo la Licencia MIT - ve el archivo [LICENSE](LICENSE) para mÃ¡s detalles.

## ğŸ“ Soporte

- **Issues**: [GitHub Issues](https://github.com/andrescris/alimedia/issues)
- **Email**: andres@ejemplo.com
- **DocumentaciÃ³n**: `http://localhost:8080/api/v1/docs`

## ğŸ™ Agradecimientos

- [Gin Framework](https://github.com/gin-gonic/gin) - Framework HTTP
- [Firebase Admin SDK](https://firebase.google.com/docs/admin/setup) - Backend services
- [Go Community](https://golang.org/community/) - Por el excelente lenguaje

---

**Hecho con â¤ï¸ en Go**
